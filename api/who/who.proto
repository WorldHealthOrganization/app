syntax = "proto3";

package who;

message Void {}

// None of these responses are cacheable.
// Clients must send a client ID header.
service WhoService {

  rpc putDeviceToken(PutDeviceTokenRequest) returns (Void);

  // The client should not pass a precise location.
  rpc putLocation(PutLocationRequest) returns (Void);

  // TODO: Add location-specific stats.
}

// These responses are publicly cacheable and clients must
// not send a client ID header.
service PublicWhoService {
  rpc getGlobalStats(Void) returns (GetGlobalStatsResponse);
}

message PutDeviceTokenRequest {
  string token = 1;
}

message PutLocationRequest {
  double latitude = 2;
  double longitude = 3;
}

message GetGlobalStatsResponse {
  CaseStats stats = 1;
  string attribution = 2;
}

// Statistics in a single or aggregate jurisdiction.
message CaseStats {
  // msec since epoch.
  int64 lastUpdated = 1;

  int64 cases = 2;
  int64 deaths = 3;
  int64 recoveries = 4;
}

enum Platform {
  IOS = 0;
  ANDROID = 1;
  WEB = 2;
}